<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Zot Registry"><link href=https://zotregistry.dev/v2.1.12/articles/cve-scanning/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.32"><title>CVE Scanning with zot - zotregistry.dev</title><link rel=stylesheet href=../../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/custom.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=teal> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#cve-scanning-with-zot class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://zotregistry.dev title=zotregistry.dev class="md-header__button md-logo" aria-label=zotregistry.dev data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> zotregistry.dev </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> CVE Scanning with zot </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/project-zot/zot title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> project-zot/zot </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://zotregistry.dev title=zotregistry.dev class="md-nav__button md-logo" aria-label=zotregistry.dev data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> zotregistry.dev </label> <div class=md-nav__source> <a href=https://github.com/project-zot/zot title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> project-zot/zot </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../general/whats-new/ class=md-nav__link> <span class=md-ellipsis> What's New </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> General </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> General </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../general/concepts/ class=md-nav__link> <span class=md-ellipsis> Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../general/features/ class=md-nav__link> <span class=md-ellipsis> Key Features </span> </a> </li> <li class=md-nav__item> <a href=../../general/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../general/extensions/ class=md-nav__link> <span class=md-ellipsis> Extensions </span> </a> </li> <li class=md-nav__item> <a href=../../general/releases/ class=md-nav__link> <span class=md-ellipsis> Released Images </span> </a> </li> <li class=md-nav__item> <a href=../../general/glossary/ class=md-nav__link> <span class=md-ellipsis> Glossary </span> </a> </li> <li class=md-nav__item> <a href=../../general/project/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> User Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> User Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guides/user-guide-datapath/ class=md-nav__link> <span class=md-ellipsis> Push and Pull Image Content </span> </a> </li> <li class=md-nav__item> <a href=../../user-guides/user-guide-gui/ class=md-nav__link> <span class=md-ellipsis> Use the Web Interface to Find Images </span> </a> </li> <li class=md-nav__item> <a href=../../user-guides/zli/ class=md-nav__link> <span class=md-ellipsis> Command Line (zli) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Installation Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Installation Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../install-guides/install-guide-linux/ class=md-nav__link> <span class=md-ellipsis> Installing zot on Bare Metal Linux </span> </a> </li> <li class=md-nav__item> <a href=../../install-guides/install-guide-k8s/ class=md-nav__link> <span class=md-ellipsis> Installing zot with Kubernetes and Helm </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Administrator Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Administrator Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin-guide/admin-getting-started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../admin-guide/admin-configuration/ class=md-nav__link> <span class=md-ellipsis> Configuring zot </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Developer Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Developer Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer-guide/onboarding/ class=md-nav__link> <span class=md-ellipsis> Onboarding </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/extensions-dev/ class=md-nav__link> <span class=md-ellipsis> Extensions </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/api-user-guide/ class=md-nav__link> <span class=md-ellipsis> Using the API </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/api-reference/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Articles </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Articles </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../building-ci-cd-pipeline/ class=md-nav__link> <span class=md-ellipsis> CI/CD Pipeline </span> </a> </li> <li class=md-nav__item> <a href=../authn-authz/ class=md-nav__link> <span class=md-ellipsis> Authentication and Authorization </span> </a> </li> <li class=md-nav__item> <a href=../verifying-signatures/ class=md-nav__link> <span class=md-ellipsis> Verifying Image Signatures </span> </a> </li> <li class=md-nav__item> <a href=../immutable-tags/ class=md-nav__link> <span class=md-ellipsis> Immutable Tags </span> </a> </li> <li class=md-nav__item> <a href=../workflow/ class=md-nav__link> <span class=md-ellipsis> Software Provenance Workflow Using OCI Artifacts </span> </a> </li> <li class=md-nav__item> <a href=../security-posture/ class=md-nav__link> <span class=md-ellipsis> Security Posture </span> </a> </li> <li class=md-nav__item> <a href=../storage/ class=md-nav__link> <span class=md-ellipsis> Storage Planning </span> </a> </li> <li class=md-nav__item> <a href=../retention/ class=md-nav__link> <span class=md-ellipsis> Retention Policies </span> </a> </li> <li class=md-nav__item> <a href=../mirroring/ class=md-nav__link> <span class=md-ellipsis> Mirroring </span> </a> </li> <li class=md-nav__item> <a href=../clustering/ class=md-nav__link> <span class=md-ellipsis> Clustering </span> </a> </li> <li class=md-nav__item> <a href=../scaleout/ class=md-nav__link> <span class=md-ellipsis> Scale-out clustering </span> </a> </li> <li class=md-nav__item> <a href=../high-availability/ class=md-nav__link> <span class=md-ellipsis> Deploying a Highly Available Registry </span> </a> </li> <li class=md-nav__item> <a href=../monitoring/ class=md-nav__link> <span class=md-ellipsis> Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../graphql/ class=md-nav__link> <span class=md-ellipsis> Using GraphQL for Enhanced Searches </span> </a> </li> <li class=md-nav__item> <a href=../benchmarking-with-zb/ class=md-nav__link> <span class=md-ellipsis> Benchmarking with zb </span> </a> </li> <li class=md-nav__item> <a href=../pprofiling/ class=md-nav__link> <span class=md-ellipsis> Performance Profiling </span> </a> </li> <li class=md-nav__item> <a href=../kind-deploy/ class=md-nav__link> <span class=md-ellipsis> Using kind for Deployment Testing </span> </a> </li> <li class=md-nav__item> <a href=../containerd/ class=md-nav__link> <span class=md-ellipsis> _containerd_ Mirroring From _zot_ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#how-it-works class=md-nav__link> <span class=md-ellipsis> How It Works </span> </a> <nav class=md-nav aria-label="How It Works"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#architecture class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=#using-trivy class=md-nav__link> <span class=md-ellipsis> Using Trivy </span> </a> </li> <li class=md-nav__item> <a href=#supported-image-formats class=md-nav__link> <span class=md-ellipsis> Supported Image Formats </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> <nav class=md-nav aria-label=Configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-configuration class=md-nav__link> <span class=md-ellipsis> Basic Configuration </span> </a> </li> <li class=md-nav__item> <a href=#configuration-with-custom-trivy-databases class=md-nav__link> <span class=md-ellipsis> Configuration with Custom Trivy Databases </span> </a> </li> <li class=md-nav__item> <a href=#configuration-options class=md-nav__link> <span class=md-ellipsis> Configuration Options </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#example-configurations class=md-nav__link> <span class=md-ellipsis> Example Configurations </span> </a> <nav class=md-nav aria-label="Example Configurations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#minimal-configuration class=md-nav__link> <span class=md-ellipsis> Minimal Configuration </span> </a> </li> <li class=md-nav__item> <a href=#configuration-with-multiple-storage-paths class=md-nav__link> <span class=md-ellipsis> Configuration with Multiple Storage Paths </span> </a> </li> <li class=md-nav__item> <a href=#configuration-with-custom-database-repositories class=md-nav__link> <span class=md-ellipsis> Configuration with Custom Database Repositories </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#usage class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> <nav class=md-nav aria-label=Usage> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cli-commands class=md-nav__link> <span class=md-ellipsis> CLI Commands </span> </a> <nav class=md-nav aria-label="CLI Commands"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#list-cves-for-an-image class=md-nav__link> <span class=md-ellipsis> List CVEs for an Image </span> </a> </li> <li class=md-nav__item> <a href=#find-images-affected-by-a-cve class=md-nav__link> <span class=md-ellipsis> Find Images Affected by a CVE </span> </a> </li> <li class=md-nav__item> <a href=#find-tags-where-a-cve-is-fixed class=md-nav__link> <span class=md-ellipsis> Find Tags Where a CVE is Fixed </span> </a> </li> <li class=md-nav__item> <a href=#compare-cves-between-images class=md-nav__link> <span class=md-ellipsis> Compare CVEs Between Images </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#graphql-api class=md-nav__link> <span class=md-ellipsis> GraphQL API </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#how-scanning-works-internally class=md-nav__link> <span class=md-ellipsis> How Scanning Works Internally </span> </a> <nav class=md-nav aria-label="How Scanning Works Internally"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#database-updates class=md-nav__link> <span class=md-ellipsis> Database Updates </span> </a> </li> <li class=md-nav__item> <a href=#image-scanning class=md-nav__link> <span class=md-ellipsis> Image Scanning </span> </a> </li> <li class=md-nav__item> <a href=#multi-arch-image-support class=md-nav__link> <span class=md-ellipsis> Multi-Arch Image Support </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#storage-structure class=md-nav__link> <span class=md-ellipsis> Storage Structure </span> </a> </li> <li class=md-nav__item> <a href=#performance-considerations class=md-nav__link> <span class=md-ellipsis> Performance Considerations </span> </a> </li> <li class=md-nav__item> <a href=#limitations class=md-nav__link> <span class=md-ellipsis> Limitations </span> </a> </li> <li class=md-nav__item> <a href=#related-documentation class=md-nav__link> <span class=md-ellipsis> Related Documentation </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=cve-scanning-with-zot>CVE Scanning with zot<a class=headerlink href=#cve-scanning-with-zot title="Permanent link">&para;</a></h1> <blockquote> <p><img alt=ðŸ‘‰ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/1f449.svg title=:point_right:> The CVE (Common Vulnerabilities and Exposures) scanning extension provides vulnerability detection for container images stored in zot. It uses <a href=https://github.com/aquasecurity/trivy>Trivy</a>, a comprehensive security scanner, to identify vulnerabilities in container images.</p> </blockquote> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>The CVE scanning feature enables zot to:</p> <ul> <li>Scan container images for known vulnerabilities</li> <li>Maintain an up-to-date vulnerability database</li> <li>Provide CVE information through the search API and CLI</li> <li>Cache scan results for improved performance</li> <li>Support both single manifest images and multi-arch image indexes</li> </ul> <h2 id=how-it-works>How It Works<a class=headerlink href=#how-it-works title="Permanent link">&para;</a></h2> <h3 id=architecture>Architecture<a class=headerlink href=#architecture title="Permanent link">&para;</a></h3> <p>The CVE scanning extension integrates Trivy as a library to perform vulnerability scans:</p> <ol> <li> <p><strong>Database Management</strong>: Trivy vulnerability databases are downloaded and stored locally in <code>_trivy</code> directories under each storage root. The databases are updated periodically based on the configured <code>updateInterval</code>.</p> </li> <li> <p><strong>Scanning Process</strong>: When an image is scanned:</p> </li> <li>The image layers are analyzed for installed packages (OS packages and application libraries)</li> <li>The Trivy scanner matches detected packages against the vulnerability database</li> <li>Results are cached to avoid redundant scans</li> <li> <p>CVE information is returned with severity levels, package details, and fix versions</p> </li> <li> <p><strong>Automatic Background Scanning</strong>: Images are automatically scanned in the background by a scheduler task that runs every 15 minutes (hardcoded, not configurable). This task starts as soon as zot starts and the Trivy database is downloaded. The scheduler checks for unscanned images and processes them in the background.</p> </li> </ol> <blockquote> <p><img alt=âœ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/270f.svg title=:pencil2:> Scanning does not occur on image push; it happens asynchronously via the scheduler.</p> </blockquote> <ol> <li><strong>On-Demand Scanning</strong>: If a user requests CVE results for an image that doesn't have cached results, the image is scanned immediately. The request will block until the scan completes and results are available. This ensures users always get results, even for newly pushed images that haven't been processed by the background scanner yet.</li> </ol> <h3 id=using-trivy>Using Trivy<a class=headerlink href=#using-trivy title="Permanent link">&para;</a></h3> <p>zot uses Trivy as an embedded library, not as an external binary. This means:</p> <ul> <li>No separate Trivy installation is required</li> <li>Trivy databases are downloaded from container registries (default: <code>ghcr.io/aquasecurity/trivy-db</code>)</li> <li>Scans run offline using the local database</li> <li>The Trivy cache is stored in <code>_trivy</code> directories under each storage root</li> </ul> <p>Our Trivy integration supports:</p> <ul> <li><strong>OS Packages</strong>: Vulnerabilities in operating system packages (e.g., apt, yum, apk packages)</li> <li><strong>Application Libraries</strong>: Vulnerabilities in application dependencies (e.g., npm, pip, maven packages)</li> <li><strong>Java Dependencies</strong>: Special support for Java applications via the Trivy Java database</li> </ul> <p>The scan configuration is equivalent to running <code>trivy image --scanners vuln --vuln-type os,library</code>. zot uses Trivy as a Go library with additional options for database management, image input handling, and result processing.</p> <h3 id=supported-image-formats>Supported Image Formats<a class=headerlink href=#supported-image-formats title="Permanent link">&para;</a></h3> <p>The CVE scanner supports:</p> <ul> <li><strong>Single Manifest Images</strong>: Standard OCI/Docker images with a single manifest</li> <li><strong>Multi-Arch Indexes</strong>: Images with multiple platform-specific manifests (e.g., linux/amd64, linux/arm64)</li> <li><strong>Layer Types</strong>: Standard compressed and uncompressed image layers</li> </ul> <blockquote> <p><img alt=âš  class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/26a0.svg title=:warning:> Images with unsupported layer media types cannot be scanned and will return an error.</p> </blockquote> <h2 id=prerequisites>Prerequisites<a class=headerlink href=#prerequisites title="Permanent link">&para;</a></h2> <p>Before enabling CVE scanning, ensure the following prerequisites are met:</p> <ol> <li> <p><strong>Search Extension Required</strong>: The search extension is mandatory for CVE scanning. It is the only way to access scan results. zot must be built with the <code>search</code> extension enabled (this is typically the default in standard builds).</p> </li> <li> <p><strong>Storage Access</strong>: The zot process needs write access to the storage root directory to create the <code>_trivy</code> cache directories. Ensure zot has write permissions to the storage directory.</p> </li> <li> <p><strong>Temporary Directory Space and Permissions</strong>: The Trivy library requires sufficient space and write permissions on the temporary partition (<code>/tmp</code> by default). This space is needed for:</p> </li> <li><strong>Database Downloads</strong>: Trivy databases are initially downloaded to <code>/tmp</code> before being moved to the final destination under the zot root directory</li> <li><strong>Layer Unpacking</strong>: Large image layers are unpacked under <code>/tmp</code> during scanning. Smaller layers are unpacked in-memory</li> </ol> <p>Ensure your system has adequate <code>/tmp</code> space and write permissions, especially if scanning images with large layers.</p> <ol> <li><strong>Network Access</strong>: zot needs network access to download Trivy databases from container registries. The initial database download and periodic updates require connectivity to the configured registry (default: <code>ghcr.io/aquasecurity/*</code>).</li> </ol> <h2 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h2> <p>To enable CVE scanning, you need to:</p> <ol> <li>Enable the search extension</li> <li>Configure CVE scanning settings</li> </ol> <h3 id=basic-configuration>Basic Configuration<a class=headerlink href=#basic-configuration title="Permanent link">&para;</a></h3> <p>The minimal configuration to enable CVE scanning:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=p>{</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>    </span><span class=nt>&quot;extensions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>        </span><span class=nt>&quot;search&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>            </span><span class=nt>&quot;enable&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>            </span><span class=nt>&quot;cve&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>                </span><span class=nt>&quot;updateInterval&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;24h&quot;</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>            </span><span class=p>}</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=p>}</span>
</code></pre></div> <p>You can also omit <code>updateInterval</code> entirely, and it will default to 2 hours:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=p>{</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>    </span><span class=nt>&quot;extensions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>        </span><span class=nt>&quot;search&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>            </span><span class=nt>&quot;enable&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>            </span><span class=nt>&quot;cve&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{}</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=p>}</span>
</code></pre></div> <h3 id=configuration-with-custom-trivy-databases>Configuration with Custom Trivy Databases<a class=headerlink href=#configuration-with-custom-trivy-databases title="Permanent link">&para;</a></h3> <p>You can customize the Trivy database repositories:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=p>{</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>    </span><span class=nt>&quot;extensions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>        </span><span class=nt>&quot;search&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>            </span><span class=nt>&quot;enable&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>            </span><span class=nt>&quot;cve&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>                </span><span class=nt>&quot;updateInterval&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;24h&quot;</span><span class=p>,</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>                </span><span class=nt>&quot;trivy&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>                    </span><span class=nt>&quot;dbRepository&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ghcr.io/aquasecurity/trivy-db&quot;</span><span class=p>,</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>                    </span><span class=nt>&quot;javaDBRepository&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ghcr.io/aquasecurity/trivy-java-db&quot;</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>                </span><span class=p>}</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w>            </span><span class=p>}</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=p>}</span>
</code></pre></div> <h3 id=configuration-options>Configuration Options<a class=headerlink href=#configuration-options title="Permanent link">&para;</a></h3> <p>The following table lists the configurable attributes for CVE scanning.</p> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>extensions.search.enable</code></td> <td>boolean</td> <td><code>false</code></td> <td>Enable the search extension (required for CVE scanning)</td> </tr> <tr> <td><code>extensions.search.cve.updateInterval</code></td> <td>duration</td> <td><code>2h</code></td> <td>Interval for updating Trivy databases (minimum: 2 hours). <strong>Note</strong>: This controls database updates, not scan frequency.</td> </tr> <tr> <td><code>extensions.search.cve.trivy.dbRepository</code></td> <td>string</td> <td><code>ghcr.io/aquasecurity/trivy-db</code></td> <td>Container registry URL for Trivy vulnerability database</td> </tr> <tr> <td><code>extensions.search.cve.trivy.javaDBRepository</code></td> <td>string</td> <td><code>ghcr.io/aquasecurity/trivy-java-db</code></td> <td>Container registry URL for Trivy Java vulnerability database</td> </tr> </tbody> </table> <blockquote> <p><img alt=âœ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/270f.svg title=:pencil2:> The <code>updateInterval</code> is <strong>optional</strong>. If not specified, it defaults to 2 hours. If a value less than 2 hours is specified, it will be automatically adjusted to 2 hours.</p> <p><img alt=âœ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/270f.svg title=:pencil2:> The automatic image scanning interval is <strong>not configurable</strong> and is hardcoded to 15 minutes. This is separate from the database update interval.</p> </blockquote> <h2 id=example-configurations>Example Configurations<a class=headerlink href=#example-configurations title="Permanent link">&para;</a></h2> <h3 id=minimal-configuration>Minimal Configuration<a class=headerlink href=#minimal-configuration title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=p>{</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>    </span><span class=nt>&quot;distSpecVersion&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1.1.1&quot;</span><span class=p>,</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>    </span><span class=nt>&quot;storage&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>        </span><span class=nt>&quot;rootDirectory&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/tmp/zot&quot;</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>        </span><span class=nt>&quot;address&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>        </span><span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;8080&quot;</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>    </span><span class=nt>&quot;extensions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>        </span><span class=nt>&quot;search&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>            </span><span class=nt>&quot;enable&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=w>            </span><span class=nt>&quot;cve&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=w>                </span><span class=nt>&quot;updateInterval&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;24h&quot;</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=w>            </span><span class=p>}</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=p>}</span>
</code></pre></div> <h3 id=configuration-with-multiple-storage-paths>Configuration with Multiple Storage Paths<a class=headerlink href=#configuration-with-multiple-storage-paths title="Permanent link">&para;</a></h3> <p>When using sub-paths for storage, each storage location will have its own Trivy database:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=p>{</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span><span class=nt>&quot;distSpecVersion&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1.1.1&quot;</span><span class=p>,</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>    </span><span class=nt>&quot;storage&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>        </span><span class=nt>&quot;rootDirectory&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/tmp/zot&quot;</span><span class=p>,</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>        </span><span class=nt>&quot;subPaths&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>            </span><span class=nt>&quot;/infra&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>                </span><span class=nt>&quot;rootDirectory&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/tmp/zot1&quot;</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>            </span><span class=p>},</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>            </span><span class=nt>&quot;/apps&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>                </span><span class=nt>&quot;rootDirectory&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/tmp/zot2&quot;</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>            </span><span class=p>}</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=w>    </span><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=w>        </span><span class=nt>&quot;address&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=w>        </span><span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;5000&quot;</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=w>    </span><span class=nt>&quot;extensions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=w>        </span><span class=nt>&quot;search&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=w>            </span><span class=nt>&quot;enable&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=w>            </span><span class=nt>&quot;cve&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=w>                </span><span class=nt>&quot;updateInterval&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;24h&quot;</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=w>            </span><span class=p>}</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=p>}</span>
</code></pre></div> <h3 id=configuration-with-custom-database-repositories>Configuration with Custom Database Repositories<a class=headerlink href=#configuration-with-custom-database-repositories title="Permanent link">&para;</a></h3> <p>If you're using a private registry or mirror for Trivy databases:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=p>{</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=nt>&quot;distSpecVersion&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1.1.1&quot;</span><span class=p>,</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>    </span><span class=nt>&quot;storage&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>        </span><span class=nt>&quot;rootDirectory&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/tmp/zot&quot;</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>    </span><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>        </span><span class=nt>&quot;address&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>        </span><span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;8080&quot;</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>    </span><span class=nt>&quot;extensions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>        </span><span class=nt>&quot;search&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>            </span><span class=nt>&quot;enable&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>            </span><span class=nt>&quot;cve&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>                </span><span class=nt>&quot;updateInterval&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;12h&quot;</span><span class=p>,</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>                </span><span class=nt>&quot;trivy&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=w>                    </span><span class=nt>&quot;dbRepository&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;registry.example.com/trivy-db&quot;</span><span class=p>,</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>                    </span><span class=nt>&quot;javaDBRepository&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;registry.example.com/trivy-java-db&quot;</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>                </span><span class=p>}</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=w>            </span><span class=p>}</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=p>}</span>
</code></pre></div> <h2 id=usage>Usage<a class=headerlink href=#usage title="Permanent link">&para;</a></h2> <h3 id=cli-commands>CLI Commands<a class=headerlink href=#cli-commands title="Permanent link">&para;</a></h3> <p>The zot CLI (zli) provides several commands for querying CVE information. For detailed information, see the <a href=../../user-guides/zli/#_zli-cve>zli command reference</a>.</p> <h4 id=list-cves-for-an-image>List CVEs for an Image<a class=headerlink href=#list-cves-for-an-image title="Permanent link">&para;</a></h4> <p>List all CVEs found in a specific image:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>zli<span class=w> </span>cve<span class=w> </span>list<span class=w> </span>&lt;repo&gt;:&lt;tag&gt;
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=c1># or using digest</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>zli<span class=w> </span>cve<span class=w> </span>list<span class=w> </span>&lt;repo&gt;@&lt;digest&gt;
</code></pre></div> <p><strong>Options</strong>:</p> <ul> <li><code>--cve-id</code>: Filter results to a specific CVE ID</li> </ul> <p><strong>Examples</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Basic usage - list all CVEs in an image by tag</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>zli<span class=w> </span>cve<span class=w> </span>list<span class=w> </span>alpine:latest
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=c1># List CVEs using image digest</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>zli<span class=w> </span>cve<span class=w> </span>list<span class=w> </span>myapp@sha256:abc123def456...
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=c1># Filter to show only a specific CVE</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>zli<span class=w> </span>cve<span class=w> </span>list<span class=w> </span>alpine:latest<span class=w> </span>--cve-id<span class=w> </span>CVE-2021-44228
</code></pre></div></p> <h4 id=find-images-affected-by-a-cve>Find Images Affected by a CVE<a class=headerlink href=#find-images-affected-by-a-cve title="Permanent link">&para;</a></h4> <p>List all images in a repository (or all repositories) that contain a specific CVE:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>zli<span class=w> </span>cve<span class=w> </span>affected<span class=w> </span>&lt;CVE-ID&gt;
</code></pre></div> <p><strong>Options</strong>:</p> <ul> <li><code>--repo</code>: Filter results to a specific repository</li> </ul> <p><strong>Examples</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># List all images affected by a CVE across all repositories</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>zli<span class=w> </span>cve<span class=w> </span>affected<span class=w> </span>CVE-2021-44228
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=c1># Filter to show only images in a specific repository</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>zli<span class=w> </span>cve<span class=w> </span>affected<span class=w> </span>CVE-2021-44228<span class=w> </span>--repo<span class=w> </span>myapp
</code></pre></div></p> <h4 id=find-tags-where-a-cve-is-fixed>Find Tags Where a CVE is Fixed<a class=headerlink href=#find-tags-where-a-cve-is-fixed title="Permanent link">&para;</a></h4> <p>List image tags where a specific CVE has been fixed:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>zli<span class=w> </span>cve<span class=w> </span>fixed<span class=w> </span>&lt;repo&gt;<span class=w> </span>&lt;CVE-ID&gt;
</code></pre></div> <p><strong>Examples</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># List all tags where a CVE is fixed</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>zli<span class=w> </span>cve<span class=w> </span>fixed<span class=w> </span>myapp<span class=w> </span>CVE-2021-44228
</code></pre></div></p> <h4 id=compare-cves-between-images>Compare CVEs Between Images<a class=headerlink href=#compare-cves-between-images title="Permanent link">&para;</a></h4> <p>Find CVEs present in one image but not in another:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>zli<span class=w> </span>cve<span class=w> </span>diff<span class=w> </span>&lt;image1&gt;<span class=w> </span>&lt;image2&gt;
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=c1># or with platform specifications</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>zli<span class=w> </span>cve<span class=w> </span>diff<span class=w> </span>&lt;image1&gt;<span class=w> </span><span class=o>[</span>platform1<span class=o>]</span><span class=w> </span>&lt;image2&gt;<span class=w> </span><span class=o>[</span>platform2<span class=o>]</span>
</code></pre></div> <p><strong>Examples</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># Compare CVEs between two images by tag</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>zli<span class=w> </span>cve<span class=w> </span>diff<span class=w> </span>myapp:v1.0<span class=w> </span>myapp:v2.0
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=c1># Compare CVEs between two images using digest</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>zli<span class=w> </span>cve<span class=w> </span>diff<span class=w> </span>myapp@sha256:abc123...<span class=w> </span>myapp@sha256:def456...
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=c1># Compare CVEs between images with platform specification for first image</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>zli<span class=w> </span>cve<span class=w> </span>diff<span class=w> </span>myapp:v1.0<span class=w> </span>linux/amd64<span class=w> </span>myapp:v2.0
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=c1># Compare CVEs between images with platform specifications for both images</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>zli<span class=w> </span>cve<span class=w> </span>diff<span class=w> </span>myapp:v1.0<span class=w> </span>linux/amd64<span class=w> </span>myapp:v2.0<span class=w> </span>linux/arm64
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=c1># Compare CVEs between different repositories</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>zli<span class=w> </span>cve<span class=w> </span>diff<span class=w> </span>prod/app:v1.0<span class=w> </span>staging/app:v2.0
</code></pre></div></p> <h3 id=graphql-api>GraphQL API<a class=headerlink href=#graphql-api title="Permanent link">&para;</a></h3> <p>The search extension exposes a GraphQL API for querying CVE information. The endpoint is available at <code>/v2/_zot/ext/search</code>.</p> <p>For detailed GraphQL query examples, see <a href=../graphql/ >Using GraphQL for Enhanced Searches</a>.</p> <p><strong>Example Query - Get CVEs for an Image</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=k>query</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>  </span><span class=n>CVEListForImage</span><span class=p>(</span><span class=n>image</span><span class=p>:</span><span class=w> </span><span class=s>&quot;alpine:latest&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>    </span><span class=n>Tag</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>    </span><span class=n>CVEList</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=w>      </span><span class=n>Id</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=w>      </span><span class=n>Title</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=w>      </span><span class=n>Description</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=w>      </span><span class=n>Severity</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=w>      </span><span class=n>PackageList</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=w>        </span><span class=n>Name</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=w>        </span><span class=n>InstalledVersion</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=w>        </span><span class=n>FixedVersion</span>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=w>        </span><span class=n>PackagePath</span>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=p>}</span>
</code></pre></div> <p><strong>Example Query - Get Images Affected by a CVE</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=k>query</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=w>  </span><span class=n>ImageListForCVE</span><span class=p>(</span><span class=n>id</span><span class=p>:</span><span class=w> </span><span class=s>&quot;CVE-2021-44228&quot;</span><span class=p>,</span><span class=w> </span><span class=n>repo</span><span class=p>:</span><span class=w> </span><span class=s>&quot;myapp&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=w>    </span><span class=n>Tag</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=w>    </span><span class=n>ManifestDigest</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=p>}</span>
</code></pre></div> <h2 id=how-scanning-works-internally>How Scanning Works Internally<a class=headerlink href=#how-scanning-works-internally title="Permanent link">&para;</a></h2> <h3 id=database-updates>Database Updates<a class=headerlink href=#database-updates title="Permanent link">&para;</a></h3> <ol> <li> <p><strong>Initial Download</strong>: When CVE scanning is first enabled, zot downloads the Trivy databases. The databases are initially downloaded to <code>/tmp</code> (due to limitations in the ORAS download library used by Trivy) and then moved to the final destination at <code>{storageRoot}/_trivy/db/</code></p> </li> <li> <p><strong>Periodic Updates</strong>: The databases are updated automatically in the background based on the <code>updateInterval</code> setting. The update task runs as soon as zot starts and continues periodically</p> </li> <li> <p><strong>Update Process</strong>: </p> </li> <li>Downloads the latest database from the configured repository (default: <code>ghcr.io/aquasecurity/trivy-db</code>)</li> <li>Updates both the main database and Java database (if configured)</li> <li> <p>Purges the entire scan cache to ensure new scans use updated vulnerability data</p> </li> <li> <p><strong>Error Handling</strong>: If an update fails, the system will retry with exponential backoff</p> </li> <li> <p><strong>Database Sizes</strong>: </p> </li> <li>The main Trivy database is initially under 100 MB and may grow as new scan results are stored</li> <li>The Trivy Java database is larger (several hundred MB) and typically does not grow</li> </ol> <h3 id=image-scanning>Image Scanning<a class=headerlink href=#image-scanning title="Permanent link">&para;</a></h3> <ol> <li> <p><strong>Automatic Background Scanning</strong>: The scanner runs every 15 minutes (hardcoded, not configurable) to check for unscanned images</p> </li> <li> <p><strong>Cache Check</strong>: Before scanning, the system checks if results are already cached for the image digest</p> </li> <li> <p><strong>Format Validation</strong>: The image format is validated to ensure it's scannable</p> </li> <li> <p><strong>Trivy Execution</strong>: The Trivy scanner analyzes the image:</p> </li> <li>Extracts package information from image layers</li> <li>Matches packages against the vulnerability database</li> <li> <p>Identifies CVEs with severity levels</p> </li> <li> <p><strong>Result Caching</strong>: Scan results are cached using manifest digests as keys. This means:</p> </li> <li>If the same manifest is stored in different repositories or with different tag names, the cached results are reused</li> <li>If a new manifest is pushed with an existing tag name, it will be picked up on the next scheduled scan run</li> <li> <p>Cache entries are keyed by digest, not by repository or tag, enabling efficient result reuse</p> </li> <li> <p><strong>Result Formatting</strong>: CVE information is formatted and returned with:</p> </li> <li>CVE ID and title</li> <li>Severity (Unknown, Low, Medium, High, Critical)</li> <li>Affected packages with installed and fixed versions</li> <li>Package paths</li> </ol> <h3 id=multi-arch-image-support>Multi-Arch Image Support<a class=headerlink href=#multi-arch-image-support title="Permanent link">&para;</a></h3> <p>For multi-arch images (image indexes):</p> <ul> <li>Each platform-specific manifest is scanned individually</li> <li>Results are aggregated across all platforms</li> <li>The index is considered scannable if at least one manifest is scannable</li> </ul> <h2 id=storage-structure>Storage Structure<a class=headerlink href=#storage-structure title="Permanent link">&para;</a></h2> <p>When CVE scanning is enabled, zot creates the following directory structure:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>{storageRoot}/
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>â”œâ”€â”€ _trivy/
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>â”‚   â”œâ”€â”€ db/
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>â”‚   â”‚   â”œâ”€â”€ metadata.json
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>â”‚   â”‚   â””â”€â”€ trivy.db
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>â”‚   â”œâ”€â”€ fanal/
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>â”‚   â”‚   â””â”€â”€ fanal.db
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>â”‚   â””â”€â”€ java-db/
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>â”‚       â”œâ”€â”€ metadata.json
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>â”‚       â””â”€â”€ trivy-java.db
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>â””â”€â”€ (image storage)
</code></pre></div> <p>For configurations with multiple storage paths, each path will have its own <code>_trivy</code> directory.</p> <h2 id=performance-considerations>Performance Considerations<a class=headerlink href=#performance-considerations title="Permanent link">&para;</a></h2> <ol> <li> <p><strong>First Scan</strong>: The initial scan of an image may take longer as it needs to analyze all layers. Large layers are unpacked under <code>/tmp</code>, so ensure adequate temporary space</p> </li> <li> <p><strong>Cached Results</strong>: Subsequent queries for the same image digest return cached results instantly</p> </li> <li> <p><strong>Database Updates</strong>: Database updates run in the background and don't block image operations</p> </li> <li> <p><strong>Concurrent Scans</strong>: Multiple images can be scanned concurrently, but database updates are serialized</p> </li> <li> <p><strong>Cache Size</strong>: The scan cache has a default size limit (1,000,000 entries) to manage memory usage</p> </li> <li> <p><strong>On-Demand Scanning</strong>: If a scan is triggered on-demand (when results aren't cached), the request will wait for the scan to complete. This ensures accurate results but may cause delays for large images</p> </li> </ol> <h2 id=limitations>Limitations<a class=headerlink href=#limitations title="Permanent link">&para;</a></h2> <ol> <li> <p><strong>Offline Scanning Only</strong>: zot uses Trivy in offline mode; it doesn't perform real-time vulnerability lookups</p> </li> <li> <p><strong>Database Updates</strong>: Vulnerability information is only as current as the last database update. Only use trusted sources for Trivy databases. The default repositories (<code>ghcr.io/aquasecurity/*</code>) are maintained by Aqua Security. If you configure custom database repositories, ensure they are from trusted sources.</p> </li> <li> <p><strong>Image Format Support</strong>: Some image formats or layer types may not be scannable</p> </li> <li> <p><strong>Java Database</strong>: The Java database is optional; Java vulnerabilities may not be detected if not configured</p> </li> <li> <p><strong>Cache Invalidation</strong>: The cache is purged on database updates; all images will need to be rescanned</p> </li> <li> <p><strong>Scale-Out Clustering</strong>: CVE scanning is not supported for cloud deployments or scale-out clustering scenarios. In these cases, we recommend implementing a CVE repository with a zot instance outside of the cluster using a local disk for storage.</p> </li> </ol> <h2 id=related-documentation>Related Documentation<a class=headerlink href=#related-documentation title="Permanent link">&para;</a></h2> <ul> <li><a href=../../admin-guide/admin-configuration/#search_config>Configuring zot</a> - Configuration details</li> <li><a href=../../user-guides/zli/#_zli-cve>Using the command line interface (zli)</a> - CLI command reference</li> <li><a href=../graphql/ >Using GraphQL for Enhanced Searches</a> - GraphQL API examples</li> <li><a href=https://github.com/aquasecurity/trivy>Trivy Documentation</a> - Trivy scanner documentation</li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 30, 2025</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2019 - 2025 The zot project authors, All Rights Reserved. | The Linux FoundationÂ® (TLF) has registered trademarks and uses trademarks. For a list of TLF trademarks, see <a href=https://www.linuxfoundation.org/trademark-usage/ >Trademark Usage</a> </div> </div> <div class=md-social> <a href=https://github.com/project-zot/zot.git target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/zothub target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://cloud-native.slack.com/archives/C03EGRE4QGH target=_blank rel=noopener title=cloud-native.slack.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.instant", "navigation.tracking", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "search.share", "toc.follow", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.471ce7a9.min.js></script> </body> </html>