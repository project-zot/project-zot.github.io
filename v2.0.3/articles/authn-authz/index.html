<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Zot Registry"><link href=https://zotregistry.dev/v2.0.3/articles/authn-authz/ rel=canonical><link href=../building-ci-cd-pipeline/ rel=prev><link href=../verifying-signatures/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.2"><title>Authentication and Authorization - zotregistry.dev</title><link rel=stylesheet href=../../assets/stylesheets/main.f56500e0.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/custom.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=teal> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#user-authentication-and-authorization-with-zot class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://zotregistry.dev title=zotregistry.dev class="md-header__button md-logo" aria-label=zotregistry.dev data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> zotregistry.dev </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Authentication and Authorization </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/project-zot/zot title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> project-zot/zot </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://zotregistry.dev title=zotregistry.dev class="md-nav__button md-logo" aria-label=zotregistry.dev data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> zotregistry.dev </label> <div class=md-nav__source> <a href=https://github.com/project-zot/zot title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> project-zot/zot </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../general/whats-new/ class=md-nav__link> What's New </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> General <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=General data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> General </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../general/concepts/ class=md-nav__link> Concepts </a> </li> <li class=md-nav__item> <a href=../../general/features/ class=md-nav__link> Key Features </a> </li> <li class=md-nav__item> <a href=../../general/architecture/ class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=../../general/extensions/ class=md-nav__link> Extensions </a> </li> <li class=md-nav__item> <a href=../../general/releases/ class=md-nav__link> Released Images </a> </li> <li class=md-nav__item> <a href=../../general/glossary/ class=md-nav__link> Glossary </a> </li> <li class=md-nav__item> <a href=../../general/project/ class=md-nav__link> About </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> User Guides <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User Guides" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> User Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guides/user-guide-datapath/ class=md-nav__link> Push and Pull Image Content </a> </li> <li class=md-nav__item> <a href=../../user-guides/user-guide-gui/ class=md-nav__link> Use the Web Interface to Find Images </a> </li> <li class=md-nav__item> <a href=../../user-guides/zli/ class=md-nav__link> Command Line (zli) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Installation Guides <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Installation Guides" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Installation Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../install-guides/install-guide-linux/ class=md-nav__link> Installing zot on Bare Metal Linux </a> </li> <li class=md-nav__item> <a href=../../install-guides/install-guide-k8s/ class=md-nav__link> Installing zot with Kubernetes and Helm </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> Administrator Guides <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Administrator Guides" data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Administrator Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin-guide/admin-getting-started/ class=md-nav__link> Getting Started </a> </li> <li class=md-nav__item> <a href=../../admin-guide/admin-configuration/ class=md-nav__link> Configuring zot </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> Developer Guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Developer Guide" data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Developer Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer-guide/onboarding/ class=md-nav__link> Onboarding </a> </li> <li class=md-nav__item> <a href=../../developer-guide/extensions-dev/ class=md-nav__link> Extensions </a> </li> <li class=md-nav__item> <a href=../../developer-guide/api-user-guide/ class=md-nav__link> Using the API </a> </li> <li class=md-nav__item> <a href=../../developer-guide/api-reference/ class=md-nav__link> API Reference </a> </li> <li class=md-nav__item> <a href=../../developer-guide/contributing/ class=md-nav__link> Contributing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8 checked> <label class=md-nav__link for=__nav_8> Articles <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Articles data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Articles </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../building-ci-cd-pipeline/ class=md-nav__link> CI/CD Pipeline </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Authentication and Authorization <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Authentication and Authorization </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#authentication class=md-nav__link> Authentication </a> <nav class=md-nav aria-label=Authentication> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tls-authentication class=md-nav__link> TLS authentication </a> </li> <li class=md-nav__item> <a href=#http-basic-authentication class=md-nav__link> HTTP basic authentication </a> </li> <li class=md-nav__item> <a href=#http-bearer-authentication class=md-nav__link> HTTP bearer authentication </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mutual-tls-authentication class=md-nav__link> Mutual TLS authentication </a> <nav class=md-nav aria-label="Mutual TLS authentication"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#preventing-automated-attacks-with-failure-delay class=md-nav__link> Preventing automated attacks with failure delay </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#server-side-authentication class=md-nav__link> Server-side authentication </a> <nav class=md-nav aria-label="Server-side authentication"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ldap class=md-nav__link> LDAP </a> </li> <li class=md-nav__item> <a href=#htpasswd class=md-nav__link> htpasswd </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#authorization class=md-nav__link> Authorization </a> <nav class=md-nav aria-label=Authorization> <ul class=md-nav__list> <li class=md-nav__item> <a href=#access-control-policies class=md-nav__link> Access control policies </a> <nav class=md-nav aria-label="Access control policies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuring-access-control class=md-nav__link> Configuring access control </a> </li> <li class=md-nav__item> <a href=#example-access-control-configuration class=md-nav__link> Example: Access control configuration </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#social-login-using-openidoauth2 class=md-nav__link> Social login using OpenID/OAuth2 </a> <nav class=md-nav aria-label="Social login using OpenID/OAuth2"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-google-github-or-gitlab class=md-nav__link> Using Google, GitHub, or GitLab </a> </li> <li class=md-nav__item> <a href=#using-dex class=md-nav__link> Using dex </a> </li> <li class=md-nav__item> <a href=#using-openidoauth2-when-zot-is-behind-a-proxy-or-load-balancer class=md-nav__link> Using OpenID/OAuth2 when zot is behind a proxy or load balancer </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../verifying-signatures/ class=md-nav__link> Verifying Image Signatures </a> </li> <li class=md-nav__item> <a href=../immutable-tags/ class=md-nav__link> Immutable Tags </a> </li> <li class=md-nav__item> <a href=../workflow/ class=md-nav__link> Software Provenance Workflow Using OCI Artifacts </a> </li> <li class=md-nav__item> <a href=../security-posture/ class=md-nav__link> Security Posture </a> </li> <li class=md-nav__item> <a href=../storage/ class=md-nav__link> Storage Planning </a> </li> <li class=md-nav__item> <a href=../retention/ class=md-nav__link> Retention Policies </a> </li> <li class=md-nav__item> <a href=../mirroring/ class=md-nav__link> Mirroring </a> </li> <li class=md-nav__item> <a href=../clustering/ class=md-nav__link> Clustering </a> </li> <li class=md-nav__item> <a href=../monitoring/ class=md-nav__link> Monitoring </a> </li> <li class=md-nav__item> <a href=../graphql/ class=md-nav__link> Using GraphQL for Enhanced Searches </a> </li> <li class=md-nav__item> <a href=../benchmarking-with-zb/ class=md-nav__link> Benchmarking with zb </a> </li> <li class=md-nav__item> <a href=../pprofiling/ class=md-nav__link> Performance Profiling </a> </li> <li class=md-nav__item> <a href=../kind-deploy/ class=md-nav__link> Using kind for Deployment Testing </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#authentication class=md-nav__link> Authentication </a> <nav class=md-nav aria-label=Authentication> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tls-authentication class=md-nav__link> TLS authentication </a> </li> <li class=md-nav__item> <a href=#http-basic-authentication class=md-nav__link> HTTP basic authentication </a> </li> <li class=md-nav__item> <a href=#http-bearer-authentication class=md-nav__link> HTTP bearer authentication </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mutual-tls-authentication class=md-nav__link> Mutual TLS authentication </a> <nav class=md-nav aria-label="Mutual TLS authentication"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#preventing-automated-attacks-with-failure-delay class=md-nav__link> Preventing automated attacks with failure delay </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#server-side-authentication class=md-nav__link> Server-side authentication </a> <nav class=md-nav aria-label="Server-side authentication"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ldap class=md-nav__link> LDAP </a> </li> <li class=md-nav__item> <a href=#htpasswd class=md-nav__link> htpasswd </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#authorization class=md-nav__link> Authorization </a> <nav class=md-nav aria-label=Authorization> <ul class=md-nav__list> <li class=md-nav__item> <a href=#access-control-policies class=md-nav__link> Access control policies </a> <nav class=md-nav aria-label="Access control policies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuring-access-control class=md-nav__link> Configuring access control </a> </li> <li class=md-nav__item> <a href=#example-access-control-configuration class=md-nav__link> Example: Access control configuration </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#social-login-using-openidoauth2 class=md-nav__link> Social login using OpenID/OAuth2 </a> <nav class=md-nav aria-label="Social login using OpenID/OAuth2"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-google-github-or-gitlab class=md-nav__link> Using Google, GitHub, or GitLab </a> </li> <li class=md-nav__item> <a href=#using-dex class=md-nav__link> Using dex </a> </li> <li class=md-nav__item> <a href=#using-openidoauth2-when-zot-is-behind-a-proxy-or-load-balancer class=md-nav__link> Using OpenID/OAuth2 when zot is behind a proxy or load balancer </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=user-authentication-and-authorization-with-zot>User Authentication and Authorization with zot<a class=headerlink href=#user-authentication-and-authorization-with-zot title="Permanent link">&para;</a></h1> <blockquote> <p><img alt=ðŸ‘‰ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f449.svg title=:point_right:> A robust set of authentication/authorization options are supported:</p> <ul> <li> <p>Authentication</p> <ul> <li>TLS, including mTLS</li> <li>Username/password or token-based user authentication</li> <li>LDAP</li> <li>htpasswd</li> <li>OAuth2 with bearer token</li> </ul> </li> <li> <p>Authorization</p> <ul> <li>Powerful identity-based access controls for repositories or specific repository paths</li> <li>OpenID/OAuth2 social login with Google, GitHub, GitLab, and dex</li> </ul> </li> </ul> </blockquote> <p>The zot configuration model supports both authentication and authorization. Authentication credentials allow access to zot HTTP APIs. Authorization policies provide fine-grained control of the actions each authenticated user can perform in the registry.</p> <h2 id=authentication>Authentication<a class=headerlink href=#authentication title="Permanent link">&para;</a></h2> <h3 id=tls-authentication>TLS authentication<a class=headerlink href=#tls-authentication title="Permanent link">&para;</a></h3> <p>Because authentication credentials are passed over HTTP, it is imperative that TLS be enabled. You can enable and configure TLS authentication in the zot configuration file, as shown in the following example.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=err>...</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>  </span><span class=nt>&quot;tls&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span><span class=nt>&quot;cert&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/etc/zot/certs/server.cert&quot;</span><span class=p>,</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=nt>&quot;key&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/etc/zot/certs/server.key&quot;</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>  </span><span class=p>}</span>
</code></pre></div> <p>See <a href=#mtls-authentication>Mutual TLS authentication</a> for additional information about TLS.</p> <h3 id=http-basic-authentication>HTTP basic authentication<a class=headerlink href=#http-basic-authentication title="Permanent link">&para;</a></h3> <p>When <a href=https://www.rfc-editor.org/rfc/rfc7617.html>basic HTTP authentication</a> is used, the username and password credentials are joined by a colon (<code>:</code>), base64 encoded, and passed in the HTTP Authorization header.</p> <h3 id=http-bearer-authentication>HTTP bearer authentication<a class=headerlink href=#http-bearer-authentication title="Permanent link">&para;</a></h3> <p>To avoid passing the username and password credentials for every HTTP request, a zot client can use <a href=https://www.rfc-editor.org/rfc/rfc6750>bearer token-based authentication</a>. In this method, the client first authenticates with a token server and receives a short-lived token. The client then passes this token in the HTTP Authorization header, specifying <code>Bearer</code> as the authentication scheme.</p> <p>Configure bearer authentication in the zot configuration file as shown in this example.</p> <div class=highlight><pre><span></span><code>&quot;http&quot;: {
...
  &quot;auth&quot;: {
    &quot;bearer&quot;: {
      &quot;realm&quot;: &quot;https://auth.myreg.io/auth/token&quot;,
        &quot;service&quot;: &quot;myauth&quot;,
        &quot;cert&quot;: &quot;/etc/zot/auth.crt&quot;
    }
  }
</code></pre></div> <p>The following table lists the configurable attributes.</p> <table> <thead> <tr> <th>Attribute</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>realm</code></td> <td>A string typically related to the authentication scheme (<em>BASIC</em> and <em>BEARER</em>).</td> </tr> <tr> <td><code>service</code></td> <td>The name of the authentication service.</td> </tr> <tr> <td><code>cert</code></td> <td>The path and filename of the serverâ€™s SSL/TLS certificate.</td> </tr> </tbody> </table> <p><a name=mtls-authentication></a></p> <h2 id=mutual-tls-authentication>Mutual TLS authentication<a class=headerlink href=#mutual-tls-authentication title="Permanent link">&para;</a></h2> <p>zot supports basic TLS and password-less mutual TLS authentication (mTLS). Specifying a <code>cacert</code> file in the TLS section of the zot configuration file enables mTLS. The <code>cacert</code> parameter is used to validate the client-side TLS certificates.</p> <div class=highlight><pre><span></span><code>&quot;http&quot;: {
...
  &quot;tls&quot;: {
    &quot;cert&quot;: &quot;/etc/zot/certs/server.cert&quot;,
    &quot;key&quot;: &quot;/etc/zot/certs/server.key&quot;,
    &quot;cacert&quot;: &quot;/etc/zot/certs/ca.cert&quot;
  }
</code></pre></div> <p>The following table lists the configurable attributes.</p> <table> <thead> <tr> <th>Attribute</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>cert</code></td> <td>The path and filename of the serverâ€™s SSL/TLS certificate.</td> </tr> <tr> <td><code>key</code></td> <td>The path and filename of the serverâ€™s registry key.</td> </tr> <tr> <td><code>cacert</code></td> <td>The path and filename of the serverâ€™s <code>cacerts</code> file, which contains trusted certificate authority (CA) certificates.</td> </tr> </tbody> </table> <h3 id=preventing-automated-attacks-with-failure-delay>Preventing automated attacks with failure delay<a class=headerlink href=#preventing-automated-attacks-with-failure-delay title="Permanent link">&para;</a></h3> <p>To help prevent automated attacks, you can add a delayed response to an authentication failure. Configure the <code>failDelay</code> attribute in the configuration file as shown in the following example.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>  </span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>    </span><span class=nt>&quot;failDelay&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>5</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=p>}</span>
</code></pre></div> <p>The <code>failDelay</code> attribute specifies a waiting time, in seconds, before zot sends a failure notification to an authenticating user who has been denied access.</p> <h2 id=server-side-authentication>Server-side authentication<a class=headerlink href=#server-side-authentication title="Permanent link">&para;</a></h2> <p>You can implement server-side authentication for zot using <code>htpasswd</code> or LDAP or both.</p> <blockquote> <p><img alt=âœ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/270f.svg title=:pencil2:> When both <code>htpasswd</code> and LDAP configuration are specified, LDAP authentication is given preference. Because <code>htpasswd</code> authentication is strictly local and requires no remote service, <code>htpasswd</code> serves as a fail-safe authentication mechanism should LDAP become unavailable.</p> </blockquote> <h3 id=ldap>LDAP<a class=headerlink href=#ldap title="Permanent link">&para;</a></h3> <p>zot supports integration with an LDAP-based authentication service such as Microsoft Windows Active Directory (AD). Enable and configure LDAP authentication in the zot configuration file, as shown in the following example.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=err>...</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>  </span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>    </span><span class=nt>&quot;ldap&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>      </span><span class=nt>&quot;credentialsFile&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;examples/config-ldap-credentials.json&quot;</span><span class=p>,</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>      </span><span class=nt>&quot;address&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ldap.example.org&quot;</span><span class=p>,</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>      </span><span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>389</span><span class=p>,</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>      </span><span class=nt>&quot;startTLS&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>      </span><span class=nt>&quot;baseDN&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ou=Users,dc=example,dc=org&quot;</span><span class=p>,</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>      </span><span class=nt>&quot;userAttribute&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uid&quot;</span><span class=p>,</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w>      </span><span class=nt>&quot;userGroupAttribute&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;memberOf&quot;</span><span class=p>,</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w>      </span><span class=nt>&quot;bindDN&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;cn=ldap-searcher,ou=Users,dc=example,dc=org&quot;</span><span class=p>,</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w>      </span><span class=nt>&quot;bindPassword&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ldap-searcher-password&quot;</span><span class=p>,</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=w>      </span><span class=nt>&quot;skipVerify&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=w>      </span><span class=nt>&quot;subtreeSearch&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=p>}</span>
</code></pre></div> <p>The following table lists the configurable attributes for LDAP authentication.</p> <table> <thead> <tr> <th>Attribute</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>credentialsFile</code></td> <td>The path to a file containing the bind credentials for LDAP.</td> </tr> <tr> <td><code>address</code></td> <td>The IP address or hostname of the LDAP server.</td> </tr> <tr> <td><code>port</code></td> <td>The port number used by the LDAP service.</td> </tr> <tr> <td><code>startTLS</code></td> <td>Set to <code>true</code> to enable TLS communication with the LDAP server.</td> </tr> <tr> <td><code>baseDN</code></td> <td>Starting location within the LDAP directory for performing user searches.</td> </tr> <tr> <td><code>userAttribute</code></td> <td>Attribute name used to obtain the username.</td> </tr> <tr> <td><code>userGroupAttribute</code></td> <td>Attribute name used to obtain groups to which a user belongs.</td> </tr> <tr> <td><code>skipVerify</code></td> <td>Skip TLS verification.</td> </tr> <tr> <td><code>subtreeSearch</code></td> <td>Set to <code>true</code> to expand the scope for search to include subtrees of the base DN.</td> </tr> </tbody> </table> <p>To allow for separation of configuration and credentials, the credentials for the LDAP server are specified in a separate file, as shown in the following example. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=p>{</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>  </span><span class=nt>&quot;bindDN&quot;</span><span class=p>:</span><span class=s2>&quot;cn=ldap-searcher,ou=Users,dc=example,dc=org&quot;</span><span class=p>,</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>  </span><span class=nt>&quot;bindPassword&quot;</span><span class=p>:</span><span class=s2>&quot;ldap-searcher-password&quot;</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=p>}</span>
</code></pre></div> <p>The following table lists the configurable attributes of the LDAP credentials file.</p> <table> <thead> <tr> <th>Attribute</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>bindDN</code></td> <td>Base Distinguished Name for the LDAP search.</td> </tr> <tr> <td><code>bindPassword</code></td> <td>Password of the bind LDAP user.</td> </tr> </tbody> </table> <h3 id=htpasswd>htpasswd<a class=headerlink href=#htpasswd title="Permanent link">&para;</a></h3> <p>Enable and configure <code>htpasswd</code> authentication in the zot configuration file, as shown in the following example.</p> <ol> <li> <p>Create and store an <code>htpasswd</code> file on the server.</p> <div class=highlight><pre><span></span><code>$ htpasswd -bBn &lt;username&gt; &lt;password&gt; &gt;&gt; /etc/zot/htpasswd
</code></pre></div> <p><img alt=âœ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/270f.svg title=:pencil2:> For strong security, make sure to use the -B option, specifying the bcrypt hashing algorithm. This is the only algorithm supported by zot for <code>htpasswd</code>.</p> </li> <li> <p>Enable <code>htpasswd</code> authentication and configure the path to the <code>htpasswd</code> authentication in the zot configuration file.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=err>...</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>  </span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>      </span><span class=nt>&quot;htpasswd&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>        </span><span class=nt>&quot;path&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/etc/zot/htpasswd&quot;</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>      </span><span class=p>},</span>
</code></pre></div> <p>The <code>path</code> attribute specifies the path and filename of the <code>htpasswd</code> file, which contains user names and hashed passwords. </p> </li> </ol> <h2 id=authorization>Authorization<a class=headerlink href=#authorization title="Permanent link">&para;</a></h2> <p>With an access scheme that relies solely on authentication, any authenticated user would be given complete access to the registry. To better control access, zot supports identity-based repository-level access control (authorization) policies. The access control policy is a function of <em>repository</em>, <em>user</em>, and the <em>action</em> being performed on that repository.</p> <h3 id=access-control-policies>Access control policies<a class=headerlink href=#access-control-policies title="Permanent link">&para;</a></h3> <p>Five identity-based types of access control policies are supported:</p> <table> <thead> <tr> <th>Policy type</th> <th>Attribute</th> <th>Access allowed</th> </tr> </thead> <tbody> <tr> <td>Default</td> <td><code>defaultPolicy</code></td> <td>The default policy specifies what actions are allowed if a user is authenticated but does match any user-specific policy.</td> </tr> <tr> <td>User-specific</td> <td><code>users</code>, <code>actions</code></td> <td>A user-specific policy specifies access and actions for explicitly named users.</td> </tr> <tr> <td>Group-specific</td> <td><code>groups</code>, <code>actions</code></td> <td>A group-specific policy specifies access and actions for explicitly named groups.</td> </tr> <tr> <td>Anonymous</td> <td><code>anonymousPolicy</code></td> <td>An anonymous policy specifies what an unauthenticated user is allowed to do. This is an appropriate policy when you want to grant open read-only access to one or more repositories.</td> </tr> <tr> <td>Admin</td> <td><code>adminPolicy</code></td> <td>The admin policy is a global access control policy that grants privileges to perform actions on any repository.</td> </tr> </tbody> </table> <p>Access control is organized by repositories, users, and their actions. Most users of a particular repository will have similar access control requirements and can be served by a repository-specific <code>defaultPolicy</code>. Should a user require an exception to the default policy, a user-specific or group-specific override policy can be configured. </p> <p>With an <code>anonymousPolicy</code>, a repository can allow anonymous actions which do not require user authentication. Finally, one or more users can be designated as administrators, to whom the global <code>adminPolicy</code> applies.</p> <p>A user's access to a particular repository is evaluated first by whether a user-specific policy exists, then by group-specific policies, and then (in order) by default and admin policies.</p> <p>A group-specific policy can be applied within any type of access policy, including default or admin policies. The group policy name can also be used with LDAP.</p> <h4 id=configuring-access-control>Configuring access control<a class=headerlink href=#configuring-access-control title="Permanent link">&para;</a></h4> <p>User identity or group identity can be used as an authorization criterion for allowing actions on one or more repository paths. For specific users, you can choose to allow any combination of read, create, update, or delete actions on specific paths.</p> <p>When you define policies for specific repository paths, the paths can be specified explicitly or by using <code>glob</code> patterns with simple or recursive wildcards. When a repository path matches more than one path description, authorization is granted based on the policy of the longest (most specific) path matched. For example, if policies are defined for path descriptions <code>**</code> and <code>repos2/repo,</code> the <code>repos2/repo</code> path will match both <code>**</code> and <code>repos2/repo</code> descriptions. In this case, the <code>repos2/repo</code> policy will be applied because it is longer.</p> <p>Note that <code>**</code> effectively defines the default policy, as it matches any path not matched by any other per-repository policy. To override all other policies, you can specify a global admin policy.</p> <blockquote> <p><img alt=âœ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/270f.svg title=:pencil2:> Always include the read action in any policy that you define. The create, update, and delete actions cannot be used without the read action.</p> </blockquote> <h4 id=example-access-control-configuration>Example: Access control configuration<a class=headerlink href=#example-access-control-configuration title="Permanent link">&para;</a></h4> <p>Use the <code>accessControl</code> attribute in the configuration file to define a set of identity-based authorization policies, as shown in the following example.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=err>...</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>  </span><span class=nt>&quot;accessControl&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span><span class=nt>&quot;groups&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>      </span><span class=nt>&quot;group1&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>        </span><span class=nt>&quot;users&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;bob&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;mary&quot;</span><span class=p>]</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>      </span><span class=p>},</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>      </span><span class=nt>&quot;group2&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>        </span><span class=nt>&quot;users&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;alice&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;mallory&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;jim&quot;</span><span class=p>]</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>    </span><span class=nt>&quot;repositories&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>      </span><span class=nt>&quot;**&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>        </span><span class=nt>&quot;policies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[{</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>          </span><span class=nt>&quot;users&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;charlie&quot;</span><span class=p>],</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=w>          </span><span class=nt>&quot;groups&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;group2&quot;</span><span class=p>],</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>          </span><span class=nt>&quot;actions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;create&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;update&quot;</span><span class=p>]</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>        </span><span class=p>}],</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=w>        </span><span class=nt>&quot;defaultPolicy&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;create&quot;</span><span class=p>]</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=w>      </span><span class=p>},</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=w>      </span><span class=nt>&quot;tmp/**&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=w>        </span><span class=nt>&quot;anonymousPolicy&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read&quot;</span><span class=p>],</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=w>        </span><span class=nt>&quot;defaultPolicy&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;create&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;update&quot;</span><span class=p>]</span>
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=w>      </span><span class=p>},</span>
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=w>      </span><span class=nt>&quot;infra/*&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=w>        </span><span class=nt>&quot;policies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[{</span>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=w>            </span><span class=nt>&quot;users&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;alice&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;bob&quot;</span><span class=p>],</span>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=w>            </span><span class=nt>&quot;actions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;create&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;read&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;update&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;delete&quot;</span><span class=p>]</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a><span class=w>          </span><span class=p>},</span>
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a><span class=w>          </span><span class=p>{</span>
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a><span class=w>            </span><span class=nt>&quot;users&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;mallory&quot;</span><span class=p>],</span>
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a><span class=w>            </span><span class=nt>&quot;groups&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;group1&quot;</span><span class=p>],</span>
<a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a><span class=w>            </span><span class=nt>&quot;actions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;create&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;read&quot;</span><span class=p>]</span>
<a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a><span class=w>          </span><span class=p>}</span>
<a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a><span class=w>        </span><span class=p>],</span>
<a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a><span class=w>        </span><span class=nt>&quot;defaultPolicy&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read&quot;</span><span class=p>]</span>
<a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a><span class=w>      </span><span class=p>},</span>
<a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a><span class=w>      </span><span class=nt>&quot;repos2/repo&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a><span class=w>        </span><span class=nt>&quot;policies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[{</span>
<a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a><span class=w>            </span><span class=nt>&quot;users&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;bob&quot;</span><span class=p>],</span>
<a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a><span class=w>            </span><span class=nt>&quot;actions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;create&quot;</span><span class=p>]</span>
<a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a><span class=w>          </span><span class=p>},</span>
<a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a><span class=w>          </span><span class=p>{</span>
<a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a><span class=w>            </span><span class=nt>&quot;users&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;mallory&quot;</span><span class=p>],</span>
<a id=__codelineno-5-45 name=__codelineno-5-45 href=#__codelineno-5-45></a><span class=w>            </span><span class=nt>&quot;actions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;create&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;read&quot;</span><span class=p>]</span>
<a id=__codelineno-5-46 name=__codelineno-5-46 href=#__codelineno-5-46></a><span class=w>          </span><span class=p>}</span>
<a id=__codelineno-5-47 name=__codelineno-5-47 href=#__codelineno-5-47></a><span class=w>        </span><span class=p>],</span>
<a id=__codelineno-5-48 name=__codelineno-5-48 href=#__codelineno-5-48></a><span class=w>        </span><span class=nt>&quot;defaultPolicy&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read&quot;</span><span class=p>]</span>
<a id=__codelineno-5-49 name=__codelineno-5-49 href=#__codelineno-5-49></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-5-50 name=__codelineno-5-50 href=#__codelineno-5-50></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-5-51 name=__codelineno-5-51 href=#__codelineno-5-51></a><span class=w>    </span><span class=nt>&quot;adminPolicy&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-52 name=__codelineno-5-52 href=#__codelineno-5-52></a><span class=w>      </span><span class=nt>&quot;users&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;admin&quot;</span><span class=p>],</span>
<a id=__codelineno-5-53 name=__codelineno-5-53 href=#__codelineno-5-53></a><span class=w>      </span><span class=nt>&quot;actions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;create&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;update&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;delete&quot;</span><span class=p>]</span>
<a id=__codelineno-5-54 name=__codelineno-5-54 href=#__codelineno-5-54></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-5-55 name=__codelineno-5-55 href=#__codelineno-5-55></a><span class=w>  </span><span class=p>}</span>
</code></pre></div> <p>In this example, five policies are defined:</p> <ul> <li> <p>The default policy (<code>**</code>) gives all authenticated users the ability to read or create content, while giving user "charlie" and those in "group2" the additional ability to update content.</p> </li> <li> <p>The policy for <code>tmp/**</code> matches all repositories under <code>tmp</code> recursively and allows all authenticated users to read, create, or update content in those repositories. Unauthenticated users have read-only access to these repositories.</p> </li> <li> <p>The policy for <code>infra/*</code> matches all repositories directly under <code>infra.</code> Separate policies are defined for specific users, along with a default read-only policy for all other users.</p> </li> <li> <p>The policy for <code>repos2/repo</code> matches only that specific repository.</p> </li> <li> <p>An admin policy (<code>adminPolicy</code>) gives the user "admin" global authorization to read, create, update, or delete content in any repository, overriding all other policies.</p> </li> </ul> <p><img alt=âœ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/270f.svg title=:pencil2:> In releases prior to zot v2.0.0, authorization policies were defined directly under the <code>accessControl</code> key in the zot configuration file. Beginning with v2.0.0, the set of authorization policies are now defined under a new <code>repositories</code> key.</p> <p><a name=_social-login></a></p> <h3 id=social-login-using-openidoauth2>Social login using OpenID/OAuth2<a class=headerlink href=#social-login-using-openidoauth2 title="Permanent link">&para;</a></h3> <p>Social login is an authentication/authorization method in which your existing credentials for another site or service can be used to log in to a service such as zot. For example, you can log in to zot using your GitHub account credentials, and zot will contact GitHub to verify your identity using OAuth 2.0 and <a href=https://openid.net/connect/ >OpenID Connect (OIDC)</a> protocols. </p> <p>Several social login providers are supported by zot:</p> <ul> <li>github</li> <li>google</li> <li>gitlab</li> <li>oidc (for example, dex)</li> </ul> <p>The following example shows the zot configuration for these providers:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=p>{</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>  </span><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>      </span><span class=nt>&quot;openid&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>        </span><span class=nt>&quot;providers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>          </span><span class=nt>&quot;github&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>            </span><span class=nt>&quot;clientid&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_id&gt;</span><span class=p>,</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>            </span><span class=nt>&quot;clientsecret&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_secre</span><span class=kc>t</span><span class=err>&gt;</span><span class=p>,</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>            </span><span class=nt>&quot;scopes&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read:org&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;user&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;repo&quot;</span><span class=p>]</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>          </span><span class=p>},</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>          </span><span class=nt>&quot;google&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>            </span><span class=nt>&quot;issuer&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://accounts.google.com&quot;</span><span class=p>,</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>            </span><span class=nt>&quot;clientid&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_id&gt;</span><span class=p>,</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>            </span><span class=nt>&quot;clientsecret&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_secre</span><span class=kc>t</span><span class=err>&gt;</span><span class=p>,</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>            </span><span class=nt>&quot;scopes&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;openid&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;email&quot;</span><span class=p>]</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>          </span><span class=p>},</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>          </span><span class=nt>&quot;gitlab&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>            </span><span class=nt>&quot;issuer&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://gitlab.com&quot;</span><span class=p>,</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>            </span><span class=nt>&quot;clientid&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_id&gt;</span><span class=p>,</span>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>            </span><span class=nt>&quot;clientsecret&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_secre</span><span class=kc>t</span><span class=err>&gt;</span><span class=p>,</span>
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=w>            </span><span class=nt>&quot;scopes&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;openid&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;read_api&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;read_user&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;profile&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;email&quot;</span><span class=p>]</span>
<a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=w>          </span><span class=p>},</span>
<a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=w>          </span><span class=nt>&quot;oidc&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=w>            </span><span class=nt>&quot;issuer&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;http://&lt;zot-server&gt;:5556/dex&quot;</span><span class=p>,</span>
<a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=w>            </span><span class=nt>&quot;clientid&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_id&gt;</span><span class=p>,</span>
<a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=w>            </span><span class=nt>&quot;clientsecret&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_secre</span><span class=kc>t</span><span class=err>&gt;</span><span class=p>,</span>
<a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=w>            </span><span class=nt>&quot;keypath&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=w>            </span><span class=nt>&quot;scopes&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;openid&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;profile&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;email&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;groups&quot;</span><span class=p>]</span>
<a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=w>          </span><span class=p>}</span>
<a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a><span class=p>}</span>
</code></pre></div> <h4 id=using-google-github-or-gitlab>Using Google, GitHub, or GitLab<a class=headerlink href=#using-google-github-or-gitlab title="Permanent link">&para;</a></h4> <p>A client logging into zot by social login must specify a supported OpenID/OAuth2 provider as a URL query parameter. A client logging in using Google, GitHub, or GitLab must additionally specify a callback URL for redirection to a zot page after a successful authentication. </p> <p>The login URL using Google, GitHub, or GitLab uses the following format:</p> <div class=highlight><pre><span></span><code>http://&lt;zot-server&gt;/auth/login?provider=&lt;provider&gt;&amp;callback_ui=&lt;zot-server&gt;/&lt;page&gt;
</code></pre></div> <p>For example, a user logging in to the zot home page using GitHub as the authentication provider sends this URL:</p> <div class=highlight><pre><span></span><code>http://zot.example.com:8080/auth/login?provider=github&amp;callback_ui=http://zot.example.com:8080/home
</code></pre></div> <p>Based on the specified provider, zot redirects the login to a provider service with the following URL:</p> <div class=highlight><pre><span></span><code>http://&lt;zot-server&gt;/zot/auth/callback/&lt;provider&gt;
</code></pre></div> <p>For the GitHub authentication example:</p> <div class=highlight><pre><span></span><code>http://zot.example.com:8080/zot/auth/callback/github
</code></pre></div> <p><img alt=âœ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/270f.svg title=:pencil2:> If your network policy doesn't allow inbound connections, the callback will not work and this authentication method will fail.</p> <h4 id=using-dex>Using dex<a class=headerlink href=#using-dex title="Permanent link">&para;</a></h4> <p><a href=https://dexidp.io/ >dex</a> is an identity service that uses OpenID Connect (OIDC) to drive authentication for client apps, such as zot. While this section shows how to use dex with zot, zot supports other OIDC services as well.</p> <p>Like zot, dex uses a configuration file for setup. To specify zot as a client in dex, configure a <code>staticClients</code> entry in the dex configuration file with a zot callback, such as the following example in the dex configuration file:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nt>staticClients</span><span class=p>:</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">zot-client</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>    </span><span class=nt>redirectURIs</span><span class=p>:</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&#39;http://zot.example.com:8080/zot/auth/callback/oidc&#39;</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;zot&#39;</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>    </span><span class=nt>secret</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ZXhhbXBsZS1hcHAtc2VjcmV0</span>
</code></pre></div> <p>In the zot configuration file, configure dex as an OpenID auth provider as in the following example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=w>  </span><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>    </span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>      </span><span class=nt>&quot;openid&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>        </span><span class=nt>&quot;providers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>          </span><span class=nt>&quot;oidc&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=w>            </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Corporate SSO&quot;</span><span class=p>,</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=w>            </span><span class=nt>&quot;issuer&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;http://&lt;zot-server&gt;:5556/dex&quot;</span><span class=p>,</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=w>            </span><span class=nt>&quot;clientid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;zot-client&quot;</span><span class=p>,</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=w>            </span><span class=nt>&quot;clientsecret&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ZXhhbXBsZS1hcHAtc2VjcmV0&quot;</span><span class=p>,</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>            </span><span class=nt>&quot;keypath&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=w>            </span><span class=nt>&quot;scopes&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;openid&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;profile&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;email&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;groups&quot;</span><span class=p>]</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=w>          </span><span class=p>}</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=w>  </span><span class=p>}</span>
</code></pre></div> <p>A user logging in to zot using dex OpenID authentication sends a URL with dex as a URL query parameter, such as the following example:</p> <p><code>http://zot.example.com:8080/auth/login?provider=oidc</code></p> <p>For detailed information about configuring dex service, see the dex <a href=https://dexidp.io/docs/getting-started/ >Getting Started</a> documentation.</p> <h4 id=using-openidoauth2-when-zot-is-behind-a-proxy-or-load-balancer>Using OpenID/OAuth2 when zot is behind a proxy or load balancer<a class=headerlink href=#using-openidoauth2-when-zot-is-behind-a-proxy-or-load-balancer title="Permanent link">&para;</a></h4> <p>When the zot registry is running behind a proxy or load balancer, you must provide an external URL for OpenID/OAuth2 clients to redirect back to zot. This <code>externalUrl</code> attribute is the URL of the registry, as shown in this example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=w>  </span><span class=nt>&quot;http&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>    </span><span class=nt>&quot;address&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;0.0.0.0&quot;</span><span class=p>,</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>    </span><span class=nt>&quot;port&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;8080&quot;</span><span class=p>,</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>    </span><span class=nt>&quot;externalUrl&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://zot.example.com&quot;</span><span class=p>,</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>    </span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>      </span><span class=nt>&quot;openid&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>        </span><span class=nt>&quot;providers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>          </span><span class=nt>&quot;github&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>            </span><span class=nt>&quot;clientid&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_id&gt;</span><span class=p>,</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>            </span><span class=nt>&quot;clientsecret&quot;</span><span class=p>:</span><span class=w> </span><span class=err>&lt;clie</span><span class=kc>nt</span><span class=err>_secre</span><span class=kc>t</span><span class=err>&gt;</span><span class=p>,</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>            </span><span class=nt>&quot;scopes&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;read:org&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;user&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;repo&quot;</span><span class=p>]</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=w>          </span><span class=p>}</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=w>  </span><span class=p>}</span>
</code></pre></div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 5, 2024</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2019 - 2024 The zot project authors, All Rights Reserved. | The Linux FoundationÂ® (TLF) has registered trademarks and uses trademarks. For a list of TLF trademarks, see <a href=https://www.linuxfoundation.org/trademark-usage/ >Trademark Usage</a> </div> </div> <div class=md-social> <a href=https://github.com/project-zot/zot.git target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/zothub target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://cloud-native.slack.com/archives/C03EGRE4QGH target=_blank rel=noopener title=cloud-native.slack.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.instant", "navigation.tracking", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "search.share", "toc.follow", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.12658920.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.5cf534bf.min.js></script> </body> </html>